<!DOCTYPE html>
<html>
<head>
  <title>Crypto</title>
  <style>
    #usdtInput {
      width: 50px;
    }
    #sl_usdtInput {
      width: 50px;
    }
    #tp_usdtInput {
      width: 50px;
    }
    body{
      background-color: white;
    }
  </style>
</head>
<body>
  <h2>Markets</h2>

  <div>
    <label for="symbolSelect">Get the last price of</label>
    <select id="m_symbolSelect">
      <option value="BTCUSDT">BTC</option>
      <option value="ETHUSDT">ETH</option>
    </select>
    <button type="button" onclick="sendMarket()">Send</button>
  </div>
  
  <h3>Trade setting</h3>

  <div>
    <label for="symbolSelect">Symbol:</label>
    <select id="symbolSelect">
      <option value="BTCUSDT">BTC</option>
      <option value="ETHUSDT">ETH</option>
    </select>
    <label for="leverageSelect">Lvrg:</label>
    <select id="leverageSelect">
      <option value="1">1x</option>
      <option value="2">2x</option>
      <option value="3">3x</option>
      <option value="4">4x</option>
      <option value="5">5x</option>
    </select>
    <label for="usdtInput">Amount:</label>
    <input type="text" id="usdtInput">
    <button type="button" onclick="sendTrade()">Set</button>
  </div>

  <h3>Stop-loss setting</h3>

  <div>
    <label for="symbolSelect">Symbol:</label>
    <select id="sl_symbolSelect">
      <option value="BTCUSDT">BTC</option>
      <option value="ETHUSDT">ETH</option>
    </select>
    <label for="usdtInput">Desired loss:</label>
    <input type="text" id="sl_usdtInput">
    <button type="button" onclick="sendSl()">Add</button>
  </div>

  <h3>Take-profit setting</h3>

  <div>
    <label for="symbolSelect">Symbol:</label>
    <select id="tp_symbolSelect">
      <option value="BTCUSDT">BTC</option>
      <option value="ETHUSDT">ETH</option>
    </select>
    <label for="usdtInput">Desired profit:</label>
    <input type="text" id="tp_usdtInput">
    <button type="button" onclick="sendTp()">Add</button>
  </div>

  <h3>Trade queue cancelling</h3>

  <div>
    <label for="symbolSelect">Cancel trade from queue for</label>
    <select id="c_symbolSelect">
      <option value="BTCUSDT">BTC</option>
      <option value="ETHUSDT">ETH</option>
    </select>
    <button type="button" onclick="sendCanceltrade()">Cancel trade</button>
  </div>

  <h3>Open orders cancelling</h3>

  <div>
    <label for="symbolSelect">Cancel trade from queue for</label>
    <select id="o_symbolSelect">
      <option value="BTCUSDT">BTC</option>
      <option value="ETHUSDT">ETH</option>
    </select>
    <button type="button" onclick="sendCancelorders()">Cancel orders</button>
  </div>

  <h3>Position closing</h3>

  <div>
    <label for="symbolSelect">Close open position of</label>
    <select id="close_symbolSelect">
      <option value="BTCUSDT">BTC</option>
      <option value="ETHUSDT">ETH</option>
    </select>
    <button type="button" onclick="sendClose()">Close position</button>
  </div>

  <h3>Other options</h3>
  <button type="button" onclick="sendList()">List trade queue</button>
  <button type="button" onclick="sendOp()">Load open positions</button>
  <button type="button" onclick="sendCancelall()">Cancel all open orders</button>
  <h5>Note that open orders doesn't contain the trade queue.</h5>

<script>
function sendRequest(command, data) {
        const serverUrl = 'https://nominally-amused-calf.ngrok-free.app/bot-command';
        const payload = {
            command: command,
            ...data
        };

        fetch(serverUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(payload),
            })
            .then(response => response.json())
            .then(data => {
                console.log('Server Response:', data);
            })
            .catch(error => {
                console.error('Error:', error);
            });
    }

function sendTrade() {
    const symbolSelect = document.getElementById('symbolSelect');
    const leverageSelect = document.getElementById('leverageSelect');
    const usdtInput = document.getElementById('usdtInput');

    const symbol = symbolSelect.value;
    const leverage = leverageSelect.value;
    const usdtAmount = usdtInput.value;

    const data = {
        symbol: symbol,
        leverage: leverage,
        usdtAmount: usdtAmount
    };

    sendRequest('/trade', data);

    usdtInput.value = '';
}

function sendSl() {
    const symbolSelect = document.getElementById('sl_symbolSelect');
    const usdtInput = document.getElementById('sl_usdtInput');

    const sl_symbol = symbolSelect.value;
    const desired_loss = usdtInput.value;

    const data = {
        sl_symbol: sl_symbol,
        desired_loss: desired_loss
    };

    sendRequest('/sl', data);

    sl_usdtInput.value = '';
}

function sendTp() {
    const symbolSelect = document.getElementById('tp_symbolSelect');
    const usdtInput = document.getElementById('tp_usdtInput');

    const tp_symbol = symbolSelect.value;
    const desired_profit = usdtInput.value;

    const data = {
        tp_symbol: tp_symbol,
        desired_profit: desired_profit
    };

    sendRequest('/tp', data);

    tp_usdtInput.value = '';
}

function sendCanceltrade() {
    const symbolSelect = document.getElementById('c_symbolSelect');

    const c_symbol = symbolSelect.value;

    const data = {
        c_symbol: c_symbol,
    };

    sendRequest('/cancel_queue_order', data);
}

function sendMarket() {
    const symbolSelect = document.getElementById('m_symbolSelect');

    const m_symbol = symbolSelect.value;

    const data = {
        m_symbol: m_symbol,
    };

    sendRequest('/market', data);
}

function sendCancelorders() {
    const symbolSelect = document.getElementById('o_symbolSelect');

    const o_symbol = symbolSelect.value;

    const data = {
        o_symbol: o_symbol,
    };

    sendRequest('/cancel_orders', data);
}
  
function sendClose() {
    const symbolSelect = document.getElementById('close_symbolSelect');

    const close_symbol = symbolSelect.value;

    const data = {
        close_symbol: close_symbol,
    };

    sendRequest('/close', data);
}

function sendOp() {
    sendRequest('/open_positions', {});
}
  
function sendCancelall() {
    sendRequest('/cancel_all_orders', {});
}

function sendList() {
    sendRequest('/list', {});
}
</script>
</body>
</html>
